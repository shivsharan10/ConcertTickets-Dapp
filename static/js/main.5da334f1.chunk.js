(this["webpackJsonpproject-concert-tickets"]=this["webpackJsonpproject-concert-tickets"]||[]).push([[0],{131:function(e,t,n){},132:function(e,t,n){},136:function(e,t){},142:function(e,t){},143:function(e,t){},165:function(e,t){},167:function(e,t){},200:function(e,t){},202:function(e,t){},242:function(e,t){},244:function(e,t){},249:function(e,t){},251:function(e,t){},257:function(e,t){},259:function(e,t){},271:function(e,t){},274:function(e,t){},288:function(e,t){},298:function(e,t,n){"use strict";n.r(t);var c=n(5),r=n.n(c),a=n(124),s=n.n(a),i=(n(131),n(7)),o=n(14),u=n(8),l=(n(132),n(0)),j=n(22),b=j.BN,p=j.Long,d=j.bytes,O=j.units,h=n(28).toBech32Address,f=n(178).Zilliqa,x=n(65),v=x.StatusType,m=x.MessageType;var w=function(){var e=Object(c.useState)(!1),t=Object(u.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(!0),s=Object(u.a)(a,2),j=s[0],x=s[1],w=Object(c.useState)(!1),k=Object(u.a)(w,2),g=k[0],y=k[1],_=Object(c.useState)(!1),S=Object(u.a)(_,2),P=S[0],C=S[1],B=Object(c.useState)(!1),N=Object(u.a)(B,2),L=N[0],T=N[1],z=Object(c.useState)(0),E=Object(u.a)(z,2),U=E[0],A=E[1],I=Object(c.useState)(""),M=Object(u.a)(I,2),R=M[0],q=M[1],F=Object(c.useState)(""),G=Object(u.a)(F,2),Z=G[0],J=G[1],Q=Object(c.useState)(0),Y=Object(u.a)(Q,2),V=Y[0],D=Y[1],H=Object(c.useState)({}),K=Object(u.a)(H,2),W=K[0],X=K[1],$=Object(c.useState)(null),ee=Object(u.a)($,2),te=ee[0],ne=ee[1],ce=Object(c.useState)([]),re=Object(u.a)(ce,2),ae=re[0],se=re[1];function ie(e,t){return Object.keys(e).filter((function(n){return e[n]===t}))}function oe(e){for(var t=[],n=0;n<e;n++)t.push({constructor:"Pair",argtypes:["ByStr20","String"],arguments:[window.zilPay.wallet.defaultAccount.base16,""]});return t}function ue(){return(ue=Object(o.a)(Object(i.a)().mark((function e(){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,window.zilPay.wallet.connect();case 3:window.zilPay.wallet.isConnect?r(!0):alert("Zilpay connection failed, try again..."),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}function le(){return le=Object(o.a)(Object(i.a)().mark((function e(){var t,n,c,r,a,s,u,l;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=h(R),n=window.zilPay.contracts.at(t),e.next=5,n.getState();case 5:if(c=e.sent,X(c),r=window.zilPay.wallet.defaultAccount.base16.toLowerCase(),a=ie(c.token_owners,r),ne(null),0===a.length){e.next=20;break}return se(a),s=a.map((function(e){return"".concat(c.base_uri).concat(e)})),e.next=15,Promise.all(s.map(function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 15:return u=e.sent,e.next=18,Promise.all(u.map(function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 18:l=e.sent,ne(l);case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(0),console.log(e.t0);case 25:case"end":return e.stop()}}),e,null,[[0,22]])}))),le.apply(this,arguments)}function je(){return(je=Object(o.a)(Object(i.a)().mark((function e(){var t,n,c,r,a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y(!0),t=window.zilPay,333,1,n=d.pack(333,1),c=O.toQa("2000",O.Units.Li),r=h(R),e.prev=7,a=t.contracts.at(r),e.next=11,a.call("Mint",[{vname:"to",type:"ByStr20",value:window.zilPay.wallet.defaultAccount.base16},{vname:"token_uri",type:"String",value:""}],{version:n,amount:new b(W.token_price),gasPrice:c,gasLimit:p.fromNumber(1e4)});case 11:return e.next=13,de();case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(7),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[7,15]])})))).apply(this,arguments)}function be(){return(be=Object(o.a)(Object(i.a)().mark((function e(){var t,n,c,r,a,s;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==V){e.next=2;break}return e.abrupt("return");case 2:return C(!0),t=oe(V),n=window.zilPay,333,1,c=d.pack(333,1),r=O.toQa("2000",O.Units.Li),a=h(R),e.prev=10,s=n.contracts.at(a),e.next=14,s.call("BatchMint",[{vname:"to_token_uri_pair_list",type:"List (Pair (ByStr20) (String))",value:t}],{version:c,amount:new b(V*W.token_price),gasPrice:r,gasLimit:p.fromNumber(1e4)});case 14:return e.next=16,de();case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(10),console.log(e.t0);case 21:case"end":return e.stop()}}),e,null,[[10,18]])})))).apply(this,arguments)}function pe(){return(pe=Object(o.a)(Object(i.a)().mark((function e(){var t,n,c,r,a,s;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T(!0),A((t=ae).length),n=window.zilPay,333,1,c=d.pack(333,1),r=O.toQa("2000",O.Units.Li),a=h(R),e.prev=9,s=n.contracts.at(a),e.next=13,s.call("BatchBurn",[{vname:"token_id_list",type:"List (Uint256)",value:t}],{version:c,amount:new b(0),gasPrice:r,gasLimit:p.fromNumber(1e4)});case 13:return e.next=15,de();case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(9),console.log(e.t0);case 20:case"end":return e.stop()}}),e,null,[[9,17]])})))).apply(this,arguments)}function de(){return Oe.apply(this,arguments)}function Oe(){return(Oe=Object(o.a)(Object(i.a)().mark((function e(){var t,n;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new f("https://dev-api.zilliqa.com"),(n=t.subscriptionBuilder.buildEventLogSubscriptions("wss://dev-ws.zilliqa.com",{addresses:[R]})).emitter.on(v.SUBSCRIBE_EVENT_LOG,(function(e){console.log("get SubscribeEventLog echo: ",e)})),n.emitter.on(m.EVENT_LOG,(function(e){if(console.log("get new event log: ",JSON.stringify(e)),e.value){var t=e.value[0].event_logs[0]._eventname;"Mint"===t&&y(!1),"BatchMint"===t&&C(!1),"Burn"===t&&T(!1),x(!0)}})),n.emitter.on(m.UNSUBSCRIBE,(function(e){console.log("get unsubscribe event: ",e)})),e.next=7,n.start();case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(c.useEffect)((function(){R&&function(){le.apply(this,arguments)}(),x(!1)}),[R,j]),Object(l.jsx)("div",{className:"App",children:Object(l.jsxs)("header",{className:"App-header",children:[Object(l.jsx)("h1",{children:"Project Concert Tickets"}),!1===n?Object(l.jsxs)("div",{children:[Object(l.jsx)("p",{children:"Connect your ZilPay wallet to get started!"}),Object(l.jsx)("button",{onClick:function(){return ue.apply(this,arguments)},children:"Connect ZilPay"})]}):""===R?Object(l.jsx)("div",{children:Object(l.jsxs)("label",{children:["Contract address:"," ",Object(l.jsx)("input",{type:"text",size:"40",placeholder:"Base16 format",required:!0,onChange:function(e){return J(e.target.value)}}),Object(l.jsx)("button",{onClick:function(){q(Z)},children:"Submit"})]})}):Object(l.jsxs)("div",{children:[Object(l.jsx)("img",{src:"banner.png",alt:"Banner",width:"800"}),Object(l.jsx)("br",{}),Object(l.jsxs)("div",{className:"grid",children:[Object(l.jsxs)("div",{children:[Object(l.jsx)("h3",{children:Object(l.jsx)("u",{children:"Contract Information"})}),Object(l.jsxs)("p",{children:["Address: ",R]}),Object(l.jsxs)("p",{children:["Name: ",W.token_name]}),Object(l.jsxs)("p",{children:["Owner: ",W.contract_owner]}),Object(l.jsxs)("p",{children:["Price: ",W.token_price/1e6||""," LI"]}),Object(l.jsxs)("p",{children:["Total Tickets: ",W.max_token_supply]})]}),Object(l.jsxs)("div",{children:[Object(l.jsx)("h3",{children:Object(l.jsx)("u",{children:"Purchasing Counter"})}),Object(l.jsxs)("p",{children:["No. of Tickets sold: ",W.token_id_count]}),Object(l.jsxs)("p",{children:["No. of Tickets left:"," ",W.max_token_supply-W.token_id_count||0]}),g&&Object(l.jsx)("div",{className:"loader"})||W.max_token_supply-W.token_id_count===0&&Object(l.jsx)("div",{children:Object(l.jsx)("p",{children:"Tickets are sold out!"})})||Object(l.jsx)("button",{onClick:function(){return je.apply(this,arguments)},children:"Purchase Single Ticket"}),Object(l.jsx)("br",{}),Object(l.jsx)("br",{}),P&&Object(l.jsx)("div",{className:"loader"})||W.max_token_supply-W.token_id_count!==0&&Object(l.jsxs)("div",{children:[Object(l.jsx)("input",{type:"number",placeholder:"Number of Tickets",onChange:function(e){return D(e.target.value)}}),Object(l.jsx)("button",{onClick:function(){return be.apply(this,arguments)},children:"Group Purchase"})]})]}),Object(l.jsxs)("div",{children:[Object(l.jsx)("h3",{children:Object(l.jsx)("u",{children:"Concert Entry"})}),0===U||L?te?L?Object(l.jsx)("div",{className:"loader"}):Object(l.jsx)("button",{onClick:function(){return pe.apply(this,arguments)},children:"Use Tickets"}):Object(l.jsx)("p",{children:"You have no concert tickets!"}):Object(l.jsxs)("p",{children:[window.zilPay.wallet.defaultAccount.base16," has been granted access for ",U," pax!"]})]}),Object(l.jsxs)("div",{children:[Object(l.jsx)("h3",{children:Object(l.jsx)("u",{children:"Your Concert Tickets"})}),te?te.map((function(e,t){return Object(l.jsxs)("div",{children:[Object(l.jsx)("img",{src:e.resources[0].uri,alt:"Token URI",width:"300"}),Object(l.jsxs)("p",{children:["Name: ",e.name]}),Object(l.jsxs)("p",{children:["Gate: ",e.attributes[0].value," Row:"," ",e.attributes[1].value," Seat:"," ",e.attributes[2].value]})]},t)})):Object(l.jsx)("div",{children:Object(l.jsx)("p",{children:"You have no concert tickets!"})})]})]})]})]})})},k=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,299)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),c(e),r(e),a(e),s(e)}))};s.a.createRoot(document.getElementById("root")).render(Object(l.jsx)(r.a.StrictMode,{children:Object(l.jsx)(w,{})})),k()}},[[298,1,2]]]);
//# sourceMappingURL=main.5da334f1.chunk.js.map